{% extends 'app/base.html' %}
{% comment %} <link rel="stylesheet" href="../../static/css/profile.css"> {% endcomment %}
{% block title %}Profile Page{% endblock title %}
{% load static %}
{% block content %}
<h1>{{profile.avatar.url}}</h1>
<h3 name="user">
    {{profile.user}}
</h3>
    {% comment %} <img src = "{% static 'images{{profile.pic}}' %}" alt="avatar" width='240px' height='240px'> {% endcomment %}
    <img src = '{{profile.avatar.url}}' alt="avatar" width='240px' height='240px'>
    
    {% comment %} <img src = "../../../" alt="avatar" width='240px' height='240px'> {% endcomment %}
    {% comment %} <form action="/{user.id}" method="post">
        <button type="submit" name = 'follow-{{user.id}}'>follow</button>
    </form> {% endcomment %}
    <form action="./{{profile.id}}" method="post">
        {% csrf_token %}
        {% if user.is_authenticated %}
        <h1>{{user}}</h1>
           {% if profile.user != user  %}
            {% if current_user_profile in following_list %}
            <button type="submit" name ='follow'>
                unfollow</button>
            {% else %}
                <button type="submit" name ='follow'>
                    follow
                </button>
            {% endif %}
                {% endif %}
        {% endif %}
        
    </form>
    <h4>following list:</h4>
    {% for f in follower_list %}
    <p><a href="/user/{{f.id}}" target="_blank">{{f.user}}</a></p>
    
    {% endfor %}
    
    <h4>follower list:</h4>
    {% for f in following_list %}
        <p><a href="/user/{{f.id}}" target="_blank">{{f.user}}</a></p>
    {% endfor %}
    <hr>
    

<!-- Page Container -->
<div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">    
    <!-- The Grid -->
    <div class="w3-row">
      <!-- Left Column -->
      <div class="w3-col m3">
        <!-- Profile -->
        <div class="w3-card w3-round w3-white">
          <div class="w3-container">
            <h4 class="w3-center">My Profile</h4>
            <p class="w3-center"><img src="{{profile.avatar.url}}" class="w3-circle" style="height:106px;width:106px" alt="Avatar"></p>
            <h1 class="w3-center">{{profile.user}}</h1>
            <hr>
            <p><i class="fa fa-user fa-fw w3-margin-right w3-text-theme"></i>{{profile.nickname}}</p>
            <p><i class="fa fa-birthday-cake fa-fw w3-margin-right w3-text-theme"></i> {{profile.birthday}}</p>
            <div class="profile__stats w3-center">
              <div class="stat">
                <p class="stat__number">{{following_list|length}}</p>
                <a href="#" class="stat__name">Followers</a>
              </div>
              <div class="stat">
                <p class="stat__number">{{follower_list|length}}</p>
                <a href="#" class="stat__name">Followings</a>
              </div>
            </div>
            <hr>
            <h4>Followers:</h4>
            {% for f in follower_list %}
            <p><a href="/user/{{f.id}}" target="_blank">{{f.name}}</a></p>
                
            {% endfor %}
            <h4>Followings:</h4>
            {% for f in following_list %}
            <p><a href="/user/{{f.id}}" target="_blank">{{f.name}}</a></p>
            {% endfor %}
          </div>
        </div>
        <br>
      
      <!-- End Left Column -->
      </div>
      
      <!-- Middle Column -->
      <div class="w3-col m7">
        {%for post in post_list  %}
          {% if post.user_id == profile %}
            <div class="w3-container w3-card w3-white w3-round w3-margin"><br>
              <div class="w3-col m1 w3-center w3-padding-bottom w3-margin-left w3-hide-small">
                <form action="/vote/" method="post">
                  {% csrf_token %}           
                  <div class="w3-col m1 w3-center w3-padding-bottom w3-margin-left w3-hide-small" >
                    <button  name = 'upvote-{{post.id}}' class="w3-button w3-padding-small" type="submit" id="upvote">
                      <i style="color: red;" class="fa fa-arrow-up"></i>
                    </button>         
                    <div style="color: rgb(26, 26, 27);">
                  <span>
                      {% for key,value in votes.items %}
                        {% if key == post%}
                            {{value|length}}
                        {% endif %}
                    {% endfor %}
                  </span>
                    </div>
                    <button type="submit" name = 'downvote-{{post.id}}' class="w3-button w3-padding-small" id="downvote">
                      <i style="color: blue;" class="fa fa-arrow-down"></i>
                    </button>
                  </div>
                </form>
              </div>
              <div class="w3-col m10">
                <img src="{{profile.avatar.url}}" alt="Avatar" class="w3-left w3-circle  w3-margin-right w3-margin-left" style="width:60px"> 
                <span class="w3-right w3-opacity w3-padding">1 min</span>
                <h4><a href="#" style="text-decoration: none;">{{profile.user}}</a></h4><br>
              </div>

                
          <div class="w3-container">
            <hr class="w3-clear">
            <h2><b>{{post.title}}</b></h2>
            <h4>{{post.content}}</h4>
            <form action="/" method="post"></form>
            {% csrf_token %}
            <div class="w3-row-padding" style="margin:0 -16px">
              <div class="w3-half">
                {% if post.pic  %}
                  <img src="{{post.pic.url}}" style="width:100%" alt="Northern Lights" class="w3-margin-bottom">
                {% endif %}
                <h1></h1>
              </div>
            </div>
            <div class="flex-grow-1">
              <div class="form-floating mb-3">
                  <textarea class="form-control w-100" placeholder="Leave a comment here" id="my-comment" style="height:7rem;"></textarea>
              </div>
              <div class="hstack justify-content-end gap-2">
                  <button type="button" class="w3-button w3-theme-d1 w3-margin-bottom w3-right"><i class="fa fa-comment"></i> Â Comment</button> 
              </div>
            </div>
            <h5 class="text-dark">Link:<a href = "/{{post.id}}" > post number {{post.id}}</a></h5>
            <hr> 
          </div>
            
          {% endif %}
        {%endfor%}
        
        
      <!-- End Middle Column -->
      </div>
      
    <!-- End Grid -->
    </div>
    
  <!-- End Page Container -->
  </div>
</div>

{% endblock content %}
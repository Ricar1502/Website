{% extends 'app/base.html' %}
{% block title %}Profile Page{% endblock title %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="../../static/css/profile.css">

<!-- Page Container -->
<div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">    
    <!-- The Grid -->
    <div class="w3-row">
      <!-- Left Column -->
      <div class="w3-col m3">
        <!-- Profile -->
        <div class="w3-card w3-round w3-white" style="border-left: 7px solid #396afc">
          <div class="w3-container">
            <h4 class="w3-center">My Profile</h4>
            <p class="w3-center"><img src="{{profile.avatar.url}}" class="w3-circle" style="height:106px;width:106px" alt="Avatar"></p>
            <h1 class="w3-center">{{profile.user}}</h1>
            <hr>
            
            <div class="mb-5">
              <div class="w3-half w3-center">
              
                <form action="./{{profile.id}}" method="post">
                  {% csrf_token %}
                  {% include 'app/components/follow.html' %}
                </form>
          
              </div>
              <div class="w3-half w3-center">
                <form action="{{profile.id}}/chat_redirect/" method="post">
                  {% csrf_token %}
                  {% include 'app/components/viewUserChat.html' %}
                </form>
      
              </div>
            </div>
            <div class="profile__stats w3-center">
              <div class="stat">
                <p class="stat__number">{{following_list|length}}</p>
                <a href="/follower" class="stat__name">Followers</a>
              </div>
              <div class="stat">
                <p class="stat__number">{{follower_list|length}}</p>
                <a href="/following" class="stat__name">Followings</a>
              </div>
            </div>
          </div>
        </div>
        <br>
      
      <!-- End Left Column -->
      </div>
      
      <!-- Middle Column -->
      <div class="w3-col m7">
        {%for post in post_list  %}
          {% if post.user_id == profile %}
          <div class="w3-card w3-white w3-round" style="border-left: 7px solid #396afc;margin: 0 10px 10px 10px;"><br>
            <form action="/vote/" method="post">
              {% csrf_token %}           
              <div class="w3-col m1 w3-center w3-padding-bottom w3-margin-left w3-hide-small" >
                <button  name = 'upvote-{{post.id}}' class="w3-button w3-padding-small" type="submit" id="upvote">
                  <i style="color: rgb(241, 88, 88);" class="fa fa-arrow-up"></i>
                </button>         
                <div style="color: rgb(26, 26, 27);">
                  <span>
                    {% for key,value in votes.items %}
                      {% if key == post%}
                          {{value|length}}
                      {% endif %}
                    {% endfor %}
                  </span>
                </div>
                <button type="submit" name = 'downvote-{{post.id}}' class="w3-button w3-padding-small" id="downvote">
                  <i style="color: rgb(115, 115, 223);" class="fa fa-arrow-down"></i>
                </button>
              </div>
            </form>

            <div class="w3-col m10">
              <a href="#" style="text-decoration: none;">
                <img src="{{profile.avatar.url}}" alt="Avatar" class="w3-left w3-circle  w3-margin-right w3-margin-left" style="width:60px"> 
              </a>
              <span class="w3-right w3-opacity w3-padding w3-hide-small">{% include 'app/components/time.html' %}</span>
              <h4><a href="#" style="text-decoration: none;">{{profile.user}}</a></h4><br>
            </div>


            <a href="/{{post.id}}" style="text-decoration: none">
              <div class="w3-container">
                <hr class="w3-clear">
                <h3>{{post.title}}</h3>
                <p>{{post.content}}</p>
                <a href = "{{post.link}}" target="_blank" style="color: rgb(57, 138, 224);"> 
                  {% if post.link %}
                    {{post.link}}
                  {% else %}
                  {% endif %}
                </a>
                <form action="/" method="post"></form>
                {% csrf_token %}
                <div class="w3-row-padding" style="margin:0 -16px">
                    {% if post.pic  %}
                      <img src="{{post.pic.url}}" style="width:100%" alt="Northern Lights" class="w3-margin-bottom">
                    {% endif %}
                </div>
                <hr>
                <div class="flex-grow-1">
                  <div class="hstack justify-content-end gap-2">
                    <a href="/{{post.id}}" style="text-decoration: none">
                      <button type="button" class="w3-button w3-margin-bottom w3-right"><i class="fa fa-comment"></i>
                        Â Comment</button></a>
                  </div>
                </div>
              </div>
            </a>
          </div>
          {% endif %}
          
        {%endfor%}
        
      <!-- End Middle Column -->
      </div>
      
    <!-- End Grid -->
    </div>
    
  <!-- End Page Container -->
</div>

{% endblock content %}